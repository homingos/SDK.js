/**
 * flamsdk v0.0.1
 * Author: flamSdk
 * Date: 2022-08-24
 * License: MIT
 */

!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory((global=global||self).flamSdk={})}(this,(function(exports){"use strict";function closeModal(){document.getElementById("flam-sdk-ui").remove(),window.removeEventListener("message",this.receiveMessage)}var toString=Object.prototype.toString;function attribute(o,attr,type,text){if(type="array"===type?"object":type,o&&typeof o[attr]!==type)throw new Error(text)}function variable(o,type,text){if(typeof o!==type)throw new Error(text)}function value(o,values,text){if(-1===values.indexOf(o))throw new Error(text)}var assert={check:function(o,config,attributes){if(config.optional&&!o||variable(o,config.type,config.message),"object"===config.type&&attributes)for(var keys=Object.keys(attributes),index=0;index<keys.length;index++){var a=keys[index];attributes[a].optional&&!o[a]||attributes[a].condition&&!attributes[a].condition(o)||(attribute(o,a,attributes[a].type,attributes[a].message),attributes[a].values&&value(o[a],attributes[a].values,attributes[a].value_message))}},attribute:attribute,variable:variable,value:value,isArray:function(array){return this.supportsIsArray()?Array.isArray(array):"[object Array]"===toString.call(array)},supportsIsArray:function(){return null!=Array.isArray}};const PAGES_main="http://localhost:3000",PAGES_error="http://localhost:3000/error";function placeOrder({product_id:product_id,order_details:order_details,callback:callback}){if(this.clientData&&this.clientData.environment&&this.clientData.key){let url=`${PAGES_main}/?product_id=${product_id}`;this.renderWithRetry(url)}else{let url=PAGES_error+"/Something went wrong!";this.renderWithRetry({url:url,order_details:order_details,callback:callback}),callback({message:"Error Occured!"},null)}}function receiveMessage(event){if("http://localhost:3000"==event.origin)switch(console.log("event listened",event),event.data.type){case"close":this.closeModal()}}function renderWithRetry(url,productId){const body=document.querySelector("body"),styleSheet=document.createElement("style");styleSheet.type="text/css",styleSheet.innerText="\n    .flam-sdk-bg {\n      position: fixed;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n\n      min-height: 100vh;\n      min-width: 100vw;\n      border: none;\n      background: rgba(0,0,0, 0.4);\n\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    #flam-sdk-iframe {\n      position: fixed;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n\n      min-height: 100vh;\n      min-width: 100vw;\n      border: none;\n    }\n\n    .flam-sdk-loading {\n      display: inline-block;\n      position: relative;\n      width: 80px;\n      height: 80px;\n    }\n    .flam-sdk-loading div {\n      box-sizing: border-box;\n      display: block;\n      position: absolute;\n      width: 64px;\n      height: 64px;\n      margin: 8px;\n      border: 3px solid #000;\n      border-radius: 50%;\n      animation: flam-sdk-loading 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n      border-color: #000 transparent transparent transparent;\n    }\n    .flam-sdk-loading div:nth-child(1) {\n      animation-delay: -0.45s;\n    }\n    .flam-sdk-loading div:nth-child(2) {\n      animation-delay: -0.3s;\n    }\n    .flam-sdk-loading div:nth-child(3) {\n      animation-delay: -0.15s;\n    }\n    @keyframes flam-sdk-loading {\n      0% {\n        transform: rotate(0deg);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n  ",document.head.appendChild(styleSheet);const UI=document.createElement("div");UI.innerHTML=`\n      <div class="flam-sdk-ui" id="flam-sdk-ui">\n        <div class="flam-sdk-bg" id="flam-sdk-bg">\n          <div class="flam-sdk-loading" id="flam-sdk-loading"><div></div><div></div><div></div><div></div></div>\n        </div>\n        <iframe id="flam-sdk-iframe" style="opacity: 0" name="flam-sdk-iframe" src="${url}" style="opacity: 0"></iframe>\n      </div>\n    `,body.appendChild(UI),document.getElementById("flam-sdk-iframe").addEventListener("load",()=>{document.getElementById("flam-sdk-bg").style.display="none",document.getElementById("flam-sdk-iframe").style.opacity="1",window.addEventListener("message",this.receiveMessage),this.iWindow=document.getElementById("flam-sdk-iframe").contentWindow,setTimeout(()=>{this.sendMessage({type:"INITIAL_DATA",data:{}},"*")},100)})}function sendMessage(message){this.iWindow.postMessage(message,"*")}function init(clientData){try{assert.check(clientData,{type:"object",message:"clientData parameter is not valid"},{key:{type:"string",message:"key is required"},environment:{type:"string",message:"environment is required"}}),clientData.overrides&&assert.check(clientData.overrides,{type:"object",message:"overrides clientData is not valid"})}catch(err){throw new Error(err.message)}this.clientData=clientData,this.renderWithRetry=renderWithRetry,this.placeOrder=placeOrder,this.receiveMessage=receiveMessage,this.sendMessage=sendMessage,this.closeModal=closeModal}var version={raw:"0.0.1"},index={version:version,init:init};exports.default=index,exports.init=init,exports.version=version,Object.defineProperty(exports,"__esModule",{value:!0})}));
//# sourceMappingURL=flamSdk.min.js.map

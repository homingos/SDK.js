{"version":3,"file":"flamSdk.min.esm.js","sources":["../src/closeModal.js","../src/helper/assert.js","../src/constants.js","../src/placeOrder.js","../src/receiveMessage.js","../src/renderWithRetry.js","../src/sendMessage.js","../src/sdk.js","../src/version.js","../src/index.js"],"sourcesContent":["export default function closeModal() {\n    const element = document.getElementById('flam-sdk-ui');\n    element.remove();\n    window.removeEventListener('message', this.receiveMessage);\n};","var toString = Object.prototype.toString;\n\nfunction attribute(o, attr, type, text) {\n    type = type === 'array' ? 'object' : type;\n    if (o && typeof o[attr] !== type) {\n        throw new Error(text);\n    }\n}\n\nfunction variable(o, type, text) {\n    if (typeof o !== type) {\n        throw new Error(text);\n    }\n}\n\nfunction value(o, values, text) {\n    if (values.indexOf(o) === -1) {\n        throw new Error(text);\n    }\n}\n\nfunction check(o, config, attributes) {\n    if (!config.optional || o) {\n        variable(o, config.type, config.message);\n    }\n    if (config.type === 'object' && attributes) {\n        var keys = Object.keys(attributes);\n\n        for (var index = 0; index < keys.length; index++) {\n            var a = keys[index];\n            if (!attributes[a].optional || o[a]) {\n                if (!attributes[a].condition || attributes[a].condition(o)) {\n                    attribute(o, a, attributes[a].type, attributes[a].message);\n                    if (attributes[a].values) {\n                        value(o[a], attributes[a].values, attributes[a].value_message);\n                    }\n                }\n            }\n        }\n    }\n}\n\n/**\n * Wrap `Array.isArray` Polyfill for IE9\n * source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray\n *\n * @param {Array} array\n * @private\n */\nfunction isArray(array) {\n    if (this.supportsIsArray()) {\n        return Array.isArray(array);\n    }\n\n    return toString.call(array) === '[object Array]';\n}\n\nfunction supportsIsArray() {\n    return Array.isArray != null;\n}\n\nexport default {\n    check: check,\n    attribute: attribute,\n    variable: variable,\n    value: value,\n    isArray: isArray,\n    supportsIsArray: supportsIsArray\n};","export const PAGES = {\n    main: \"http://localhost:3000\",\n    error: \"http://localhost:3000/error\"\n}","import { PAGES } from './constants';\n\nexport default function placeOrder({ product_id, order_details, callback }) {\n  if (\n    !this.clientData ||\n    !this.clientData.environment ||\n    !this.clientData.key\n  ) {\n    let url = `${PAGES.error}/Something went wrong!`;\n    this.renderWithRetry({\n      url,\n      order_details,\n      callback\n    });\n    callback({ message: 'Error Occured!' }, null);\n  } else {\n    let url = `${PAGES.main}/?product_id=${product_id}`;\n    this.renderWithRetry(url);\n  }\n}\n","export default function receiveMessage(event) {\n    if (event.origin == 'http://localhost:3000') {\n        console.log('event listened', event);\n\n        switch (event.data.type) {\n            case 'close':\n                this.closeModal();\n        }\n    }\n};\n","export default function renderWithRetry(url, productId) {\n  const body = document.querySelector('body');\n\n  const styleSheet = document.createElement('style');\n  styleSheet.type = 'text/css';\n  styleSheet.innerText = `\n    .flam-sdk-bg {\n      position: fixed;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n\n      min-height: 100vh;\n      min-width: 100vw;\n      border: none;\n      background: rgba(0,0,0, 0.4);\n\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    #flam-sdk-iframe {\n      position: fixed;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n\n      min-height: 100vh;\n      min-width: 100vw;\n      border: none;\n    }\n\n    .flam-sdk-loading {\n      display: inline-block;\n      position: relative;\n      width: 80px;\n      height: 80px;\n    }\n    .flam-sdk-loading div {\n      box-sizing: border-box;\n      display: block;\n      position: absolute;\n      width: 64px;\n      height: 64px;\n      margin: 8px;\n      border: 3px solid #000;\n      border-radius: 50%;\n      animation: flam-sdk-loading 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n      border-color: #000 transparent transparent transparent;\n    }\n    .flam-sdk-loading div:nth-child(1) {\n      animation-delay: -0.45s;\n    }\n    .flam-sdk-loading div:nth-child(2) {\n      animation-delay: -0.3s;\n    }\n    .flam-sdk-loading div:nth-child(3) {\n      animation-delay: -0.15s;\n    }\n    @keyframes flam-sdk-loading {\n      0% {\n        transform: rotate(0deg);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n  `;\n\n  document.head.appendChild(styleSheet);\n\n  const UI = document.createElement('div');\n  UI.innerHTML = `\n      <div class=\"flam-sdk-ui\" id=\"flam-sdk-ui\">\n        <div class=\"flam-sdk-bg\" id=\"flam-sdk-bg\">\n          <div class=\"flam-sdk-loading\" id=\"flam-sdk-loading\"><div></div><div></div><div></div><div></div></div>\n        </div>\n        <iframe id=\"flam-sdk-iframe\" style=\"opacity: 0\" name=\"flam-sdk-iframe\" src=\"${url}\" style=\"opacity: 0\"></iframe>\n      </div>\n    `;\n\n  body.appendChild(UI);\n\n  document.getElementById('flam-sdk-iframe').addEventListener('load', () => {\n\n    // hide loading\n    document.getElementById('flam-sdk-bg').style.display = 'none';\n\n    // Bring the iframe back\n    document.getElementById('flam-sdk-iframe').style.opacity = '1';\n\n    // for receiving messages from iframe\n    window.addEventListener('message', this.receiveMessage);\n\n    // for sending messages to iframe\n    this.iWindow = document.getElementById(\"flam-sdk-iframe\").contentWindow;\n    setTimeout(() => {\n      this.sendMessage({ type: \"INITIAL_DATA\", data: {} }, \"*\")\n    }, 100)\n  });\n};","export default function sendMessage(message) {\n    this.iWindow.postMessage(message, \"*\")\n};","import closeModal from './closeModal';\nimport assert from './helper/assert';\nimport placeOrder from './placeOrder';\nimport receiveMessage from './receiveMessage';\nimport renderWithRetry from './renderWithRetry';\nimport sendMessage from './sendMessage';\n\nimport { PAGES } from \"./constants\";\n\nfunction init(clientData) {\n  /* eslint-disable */\n  try {\n    assert.check(\n      clientData,\n      { type: 'object', message: 'clientData parameter is not valid' },\n      // {\n      //   domain: { type: 'string', message: 'domain option is required' },\n      //   clientID: { type: 'string', message: 'clientID option is required' },\n      //   responseType: {\n      //     optional: true,\n      //     type: 'string',\n      //     message: 'responseType is not valid'\n      //   },\n      // }\n      {\n        key: { type: 'string', message: 'key is required' },\n        environment: {\n          type: 'string',\n          message: 'environment is required'\n        }\n      }\n    );\n\n    if (clientData.overrides) {\n      assert.check(\n        clientData.overrides,\n        { type: 'object', message: 'overrides clientData is not valid' },\n      );\n    }\n  } catch (err) {\n    throw new Error(err.message)\n  }\n\n  this.clientData = clientData;\n\n  // core methods\n  this.renderWithRetry = renderWithRetry;\n  this.placeOrder = placeOrder;\n  this.receiveMessage = receiveMessage;\n  this.sendMessage = sendMessage;\n  this.closeModal = closeModal\n\n  /* eslint-enable */\n}\n\nexport default init;","module.exports = { raw: '0.0.1' };","import init from './sdk';\nimport version from './version';\n\nexport { version, init };\n\nexport default { version: version, init: init };"],"names":["closeModal","document","getElementById","remove","window","removeEventListener","this","receiveMessage","toString","Object","prototype","attribute","o","attr","type","text","Error","variable","value","values","indexOf","check","config","attributes","optional","message","keys","index","length","a","condition","value_message","isArray","array","supportsIsArray","Array","call","PAGES","placeOrder","product_id","order_details","callback","clientData","environment","key","url","renderWithRetry","event","origin","console","log","data","productId","body","querySelector","styleSheet","createElement","innerText","head","appendChild","UI","innerHTML","addEventListener","style","display","opacity","iWindow","contentWindow","setTimeout","sendMessage","postMessage","init","assert","overrides","err","raw","version"],"mappings":";;;;;;;AAAe,SAASA,aACJC,SAASC,eAAe,eAChCC,SACRC,OAAOC,oBAAoB,UAAWC,KAAKC,gBCH/C,IAAIC,SAAWC,OAAOC,UAAUF,SAEhC,SAASG,UAAUC,EAAGC,KAAMC,KAAMC,MAE9B,GADAD,KAAgB,UAATA,KAAmB,SAAWA,KACjCF,UAAYA,EAAEC,QAAUC,KACxB,MAAM,IAAIE,MAAMD,MAIxB,SAASE,SAASL,EAAGE,KAAMC,MACvB,UAAWH,IAAME,KACb,MAAM,IAAIE,MAAMD,MAIxB,SAASG,MAAMN,EAAGO,OAAQJ,MACtB,IAA2B,IAAvBI,OAAOC,QAAQR,GACf,MAAM,IAAII,MAAMD,MA4CxB,WAAe,CACXM,MAzCJ,SAAeT,EAAGU,OAAQC,YAItB,GAHKD,OAAOE,WAAYZ,GACpBK,SAASL,EAAGU,OAAOR,KAAMQ,OAAOG,SAEhB,WAAhBH,OAAOR,MAAqBS,WAG5B,IAFA,IAAIG,KAAOjB,OAAOiB,KAAKH,YAEdI,MAAQ,EAAGA,MAAQD,KAAKE,OAAQD,QAAS,CAC9C,IAAIE,EAAIH,KAAKC,OACRJ,WAAWM,GAAGL,WAAYZ,EAAEiB,IACxBN,WAAWM,GAAGC,YAAaP,WAAWM,GAAGC,UAAUlB,KACpDD,UAAUC,EAAGiB,EAAGN,WAAWM,GAAGf,KAAMS,WAAWM,GAAGJ,SAC9CF,WAAWM,GAAGV,QACdD,MAAMN,EAAEiB,GAAIN,WAAWM,GAAGV,OAAQI,WAAWM,GAAGE,kBA6BpEpB,UAAWA,UACXM,SAAUA,SACVC,MAAOA,MACPc,QAjBJ,SAAiBC,OACb,OAAI3B,KAAK4B,kBACEC,MAAMH,QAAQC,OAGO,mBAAzBzB,SAAS4B,KAAKH,QAarBC,gBAVJ,WACI,OAAwB,MAAjBC,MAAMH,gBC1DJK,WACH,wBADGA,YAEF,uCCAaC,YAAWC,WAAEA,WAAUC,cAAEA,cAAaC,SAAEA,WAC9D,GACGnC,KAAKoC,YACLpC,KAAKoC,WAAWC,aAChBrC,KAAKoC,WAAWE,IASZ,CACL,IAAIC,IAAM,GAAGR,0BAA0BE,aACvCjC,KAAKwC,gBAAgBD,SAVrB,CACA,IAAIA,IAASR,YAAH,yBACV/B,KAAKwC,gBAAgB,CACnBD,IAAAA,IACAL,cAAAA,cACAC,SAAAA,WAEFA,SAAS,CAAEhB,QAAS,kBAAoB,OCd7B,SAASlB,eAAewC,OACnC,GAAoB,yBAAhBA,MAAMC,OAGN,OAFAC,QAAQC,IAAI,iBAAkBH,OAEtBA,MAAMI,KAAKrC,MACf,IAAK,QACDR,KAAKN,cCNN,SAAS8C,gBAAgBD,IAAKO,WAC3C,MAAMC,KAAOpD,SAASqD,cAAc,QAE9BC,WAAatD,SAASuD,cAAc,SAC1CD,WAAWzC,KAAO,WAClByC,WAAWE,UAAY,g5CAmEvBxD,SAASyD,KAAKC,YAAYJ,YAE1B,MAAMK,GAAK3D,SAASuD,cAAc,OAClCI,GAAGC,UAAY,iUAKqEhB,wDAIpFQ,KAAKM,YAAYC,IAEjB3D,SAASC,eAAe,mBAAmB4D,iBAAiB,OAAQ,KAGlE7D,SAASC,eAAe,eAAe6D,MAAMC,QAAU,OAGvD/D,SAASC,eAAe,mBAAmB6D,MAAME,QAAU,IAG3D7D,OAAO0D,iBAAiB,UAAWxD,KAAKC,gBAGxCD,KAAK4D,QAAUjE,SAASC,eAAe,mBAAmBiE,cAC1DC,WAAW,KACT9D,KAAK+D,YAAY,CAAEvD,KAAM,eAAgBqC,KAAM,IAAM,MACpD,OCrGQ,SAASkB,YAAY5C,SAChCnB,KAAK4D,QAAQI,YAAY7C,QAAS,KCQtC,SAAS8C,KAAK7B,YAEZ,IACE8B,OAAOnD,MACLqB,WACA,CAAE5B,KAAM,SAAUW,QAAS,qCAU3B,CACEmB,IAAK,CAAE9B,KAAM,SAAUW,QAAS,mBAChCkB,YAAa,CACX7B,KAAM,SACNW,QAAS,6BAKXiB,WAAW+B,WACbD,OAAOnD,MACLqB,WAAW+B,UACX,CAAE3D,KAAM,SAAUW,QAAS,sCAG/B,MAAOiD,KACP,MAAM,IAAI1D,MAAM0D,IAAIjD,SAGtBnB,KAAKoC,WAAaA,WAGlBpC,KAAKwC,gBAAkBA,gBACvBxC,KAAKgC,WAAaA,WAClBhC,KAAKC,eAAiBA,eACtBD,KAAK+D,YAAcA,YACnB/D,KAAKN,WAAaA,WClDpB,YAAiB,CAAE2E,IAAK,eCKT,CAAEC,QAASA,QAASL,KAAMA"}